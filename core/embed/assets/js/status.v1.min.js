function setup_status(){fetch("https://embed.metromap.online/request?uri=https://api.metromap.online/v1/status").then(response=>response.json()).then(data=>{if("ok"===data.status){const lines=Object.keys(data.data);for(let line of lines)if("O"!==data.data[line].status){const stations=Object.keys(data.data[line].stations);for(let i=0;i<stations.length;i++){let status=data.data[line].stations[stations[i]].status;station_status(line,stations[i],status),i<stations.length-1&&segment_status(line,stations[i],stations[i+1],status)}}}}).catch(error=>console.error(error))}function station_status(line,station,status){const linea=document.querySelector(`.linea${line}stations`);var estacion=linea.querySelector(`.${station}.station`);null!==estacion&&(estacion.classList.remove("O","M","P","U"),estacion.classList.add(status))}function segment_status(line,station1,station2,status){"O"!=status&&(status="M");const linea=document.querySelector(`.linea${line}segments`);if(null!==linea){var segment=linea.querySelector(`.${station1}.${station2}`);null!==segment&&(segment.classList.remove("O","M"),segment.classList.add(status))}}setInterval(()=>{const fechaActual=new Date;fechaActual.setMinutes(fechaActual.getMinutes()-6);const fechaMenos6Min=fechaActual.toISOString();fetch(`https://embed.metromap.online/request?uri=https://api.metromap.online/v1/incident?dt=${fechaMenos6Min}`).then(response=>response.json()).then(data=>{if("ok"==data.status){const lines=Object.keys(data.data);for(let line of lines){const stations=Object.keys(data.data[line].stations);for(let i=0;i<stations.length;i++){let status=data.data[line].stations[stations[i]].status;station_status(line,stations[i],status),i<stations.length-1&&segment_status(line,stations[i],stations[i+1],status)}}}}).catch(error=>console.error(error))},6e4),setup_status();